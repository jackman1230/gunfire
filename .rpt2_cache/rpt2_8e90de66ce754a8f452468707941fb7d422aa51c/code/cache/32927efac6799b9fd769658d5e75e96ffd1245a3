{
  "code": "import BulletBody from \"./BulletBody\";\r\nimport { ViewManager } from \"../Manager/ViewManager\";\r\nimport GameEvent from \"../Control/GameEvent\";\r\nimport { EventManager } from \"../Manager/EventManager\";\r\nexport default class RoleBullet {\r\n    constructor() {\r\n        this.bulletType = 1;\r\n        this.direction = 1;\r\n        this.speed = 35;\r\n    }\r\n    initView(type, dir) {\r\n        this.bulletType = type;\r\n        this.direction = dir;\r\n        Laya.Scene.load(\"Bullet.scene\", Laya.Handler.create(this, this.loadComplete));\r\n    }\r\n    loadComplete(s) {\r\n        console.log(\"RoleBullet.scene--loadComplete\");\r\n        this.view = fairygui.UIPackage.createObject(\"Game\", \"zidan\");\r\n        this.zidan = this.view.getChildAt(0).asLoader;\r\n        this.scene = s;\r\n        this.body = this.scene.getComponent(Laya.RigidBody);\r\n        this.zidan.url = \"ui://Game/zidan\" + this.bulletType;\r\n        this.scene.addComponent(BulletBody);\r\n        this.scene.addChild(this.view.displayObject);\r\n        this.setBulletPos();\r\n        ViewManager.instance.warView.scene.addChild(this.scene);\r\n        EventManager.instance.addNotice(GameEvent.BULLET_DISPOSE, this, this.dispose);\r\n    }\r\n    setBulletPos() {\r\n        var p1 = new Laya.Point(ViewManager.instance.rolePlayer[\"firePos\" + ViewManager.instance.rolePlayer.weaponType].x, ViewManager.instance.rolePlayer[\"firePos\" + ViewManager.instance.rolePlayer.weaponType].y);\r\n        var p = ViewManager.instance.rolePlayer.rolePlayer.displayObject.localToGlobal(p1);\r\n        var y = ViewManager.instance.bulletRandomY();\r\n        if (this.direction == 1) {\r\n            this.view.setSkew(0, 0);\r\n            if (this.bulletType == 1)\r\n                this.scene.x = Math.abs(ViewManager.instance.warView.warView.x) + p.x + this.view.width - 30;\r\n            else {\r\n                this.scene.x = Math.abs(ViewManager.instance.warView.warView.x) + p.x + this.view.width - 20;\r\n            }\r\n            this.scene.y = p.y - y;\r\n            this.body.setVelocity({ x: 10, y: 0 });\r\n        }\r\n        else {\r\n            this.view.setSkew(180, 180);\r\n            if (this.bulletType == 1)\r\n                this.scene.x = Math.abs(ViewManager.instance.warView.warView.x) + p.x - this.view.width * 2 + 30;\r\n            else {\r\n                this.scene.x = Math.abs(ViewManager.instance.warView.warView.x) + p.x + this.view.width - 20;\r\n            }\r\n            this.scene.y = p.y - y;\r\n            this.body.setVelocity({ x: -10, y: 0 });\r\n        }\r\n    }\r\n    dispose(s) {\r\n        if (s == this.scene) {\r\n            this.scene.off(GameEvent.BULLET_DISPOSE, this, this.dispose);\r\n            Laya.Pool.recover(\"roleBullet\", this);\r\n            this.view.dispose();\r\n            console.log(\"销毁子弹\");\r\n        }\r\n    }\r\n}\r\n",
  "references": [
    "D:/littleGame/gunfire/src/fui/Game/WXFUI_zidan.ts",
    "D:/littleGame/gunfire/src/View/BulletBody.ts",
    "D:/littleGame/gunfire/src/Manager/ViewManager.ts",
    "D:/littleGame/gunfire/src/Control/GameEvent.ts",
    "D:/littleGame/gunfire/src/Manager/GameManager.ts",
    "D:/littleGame/gunfire/src/Manager/EventManager.ts"
  ]
}
