{
  "code": "import PopUpView from \"../PopUpView\";\r\nimport { GameManager } from \"../../Manager/GameManager\";\r\nimport { SoundManager } from \"../../Manager/SoundManager\";\r\nimport { ViewManager } from \"../../Manager/ViewManager\";\r\nimport { MooSnowSDK } from \"../../Manager/MooSnowSDK\";\r\nimport WXFUI_freeView from \"../../fui/Game/WXFUI_freeView\";\r\nimport { VideoType, VideoInfo } from \"../../Data/VideoData\";\r\nexport default class FreeView extends PopUpView {\r\n    constructor() {\r\n        super();\r\n        this._checkBoxMistouch = false;\r\n        this._clickCount = 0;\r\n        this._randomList = [];\r\n    }\r\n    createView() {\r\n        this.view = WXFUI_freeView.createInstance();\r\n        var sdkData = MooSnowSDK.getAllConfig();\r\n        if (sdkData && sdkData.checkBoxMistouch != \"0\") {\r\n            this._checkBoxMistouch = true;\r\n            this._randomList = MooSnowSDK.getAllConfig().checkBoxProbabilitys;\r\n        }\r\n    }\r\n    showView(s, c) {\r\n        super.showView(s, c);\r\n        this.updateView();\r\n    }\r\n    updateView() {\r\n        this.view.m_ctl.selectedIndex = 0;\r\n        this._clickCount = 0;\r\n        if (this._checkBoxMistouch)\r\n            this.getRandomMisTouchIndex();\r\n        this.view.m_gou.selected = true;\r\n        this.view.m_cha.visible = false;\r\n        this.view.m_lingqu.onClick(this, this.lingquHandle);\r\n        this.view.m_gou.onClick(this, this.gouHandle);\r\n        this.view.m_fangqi.onClick(this, this.fangqiHandle);\r\n        this.view.m_cha.onClick(this, this.closeHandle);\r\n    }\r\n    showFangQiBtn() {\r\n        Laya.timer.clear(this, this.showCloseBtn);\r\n        this.view.m_ctl.selectedIndex = 1;\r\n        Laya.timer.once(3000, this, this.showCloseBtn);\r\n    }\r\n    showLingQuBtn() {\r\n        this.view.m_ctl.selectedIndex = 0;\r\n        Laya.timer.clear(this, this.showCloseBtn);\r\n    }\r\n    showCloseBtn() {\r\n        this.view.m_cha.visible = true;\r\n    }\r\n    gouHandle() {\r\n        if (this._checkBoxMistouch) {\r\n            if (this._clickCount == this._misTouchIndex) {\r\n                this.watchVideo();\r\n            }\r\n            else {\r\n                if (!this.view.m_gou.selected) {\r\n                    this.showFangQiBtn();\r\n                }\r\n                else {\r\n                    this.showLingQuBtn();\r\n                }\r\n            }\r\n            this._clickCount++;\r\n        }\r\n        else {\r\n            if (!this.view.m_gou.selected) {\r\n                this.showFangQiBtn();\r\n            }\r\n            else {\r\n                this.showLingQuBtn();\r\n            }\r\n        }\r\n    }\r\n    lingquHandle() {\r\n        this.watchVideo();\r\n    }\r\n    closeHandle() {\r\n        this.enterGame();\r\n    }\r\n    fangqiHandle() {\r\n        if (MooSnowSDK.misTouchNum == 0) {\r\n            this.enterGame();\r\n        }\r\n        else if (MooSnowSDK.misTouchNum > 0) {\r\n            GameManager.instance.misTouchNum++;\r\n            if (GameManager.instance.misTouchNum >= MooSnowSDK.misTouchNum) {\r\n                GameManager.instance.misTouchNum = 0;\r\n                this.watchVideo();\r\n            }\r\n            else {\r\n            }\r\n        }\r\n    }\r\n    enterGame() {\r\n        Laya.timer.clear(this, this.showCloseBtn);\r\n        SoundManager.instance.playSound(\"btn_click\");\r\n        ViewManager.instance.hidePopUpView(this, true);\r\n        GameManager.instance.enterGame();\r\n    }\r\n    watchVideo() {\r\n        if (!this.view.m_gou.selected) {\r\n            this.showFangQiBtn();\r\n        }\r\n        else {\r\n            this.showLingQuBtn();\r\n        }\r\n        Laya.timer.clear(this, this.showCloseBtn);\r\n        var d = GameManager.instance.levelData.shop[\"item_4\"];\r\n        var v = GameManager.instance.createVideoData(VideoType.VIDEOTYPE_ITEM, VideoInfo.VIDEOINFO_ITEM);\r\n        MooSnowSDK.showVideo(d, v, this.enterGame.bind(this), null, null, this.timeShowCloseBtn.bind(this));\r\n    }\r\n    timeShowCloseBtn() {\r\n        console.log(\"timeShowCloseBtn-\");\r\n        Laya.timer.clear(this, this.showCloseBtn);\r\n        if (!this.view.m_gou.selected)\r\n            Laya.timer.once(3000, this, this.showCloseBtn);\r\n    }\r\n    hideAllView() {\r\n        super.hideAllView();\r\n        Laya.timer.clear(this, this.showCloseBtn);\r\n        this.view.m_lingqu.offClick(this, this.lingquHandle);\r\n        this.view.m_gou.offClick(this, this.gouHandle);\r\n        this.view.m_fangqi.offClick(this, this.fangqiHandle);\r\n        this.view.m_cha.offClick(this, this.closeHandle);\r\n    }\r\n    getRandomMisTouchIndex() {\r\n        var arr = [];\r\n        var idx = 0;\r\n        for (var i = 0; i < this._randomList.length; i++) {\r\n            var num = this._randomList[i];\r\n            for (var j = 0; j < num; j++)\r\n                arr.push(idx);\r\n            idx++;\r\n        }\r\n        if (arr.length > 0)\r\n            this._misTouchIndex = arr[Math.floor(Math.random() * arr.length)];\r\n        else\r\n            this._misTouchIndex = 1000000;\r\n    }\r\n}\r\n",
  "references": [
    "D:/littleGame/gunfire/src/View/PopUpView.ts",
    "D:/littleGame/gunfire/src/Manager/GameManager.ts",
    "D:/littleGame/gunfire/src/Manager/SoundManager.ts",
    "D:/littleGame/gunfire/src/Manager/ViewManager.ts",
    "D:/littleGame/gunfire/src/Manager/MooSnowSDK.ts",
    "D:/littleGame/gunfire/src/fui/Game/WXFUI_freeView.ts",
    "D:/littleGame/gunfire/src/Data/VideoData.ts"
  ]
}
