{
  "code": "import { ViewManager } from \"../Manager/ViewManager\";\r\nimport GameEvent from \"../Control/GameEvent\";\r\nimport { EventManager } from \"../Manager/EventManager\";\r\nimport BulletBody from \"./Body/BulletBody\";\r\nimport { GameData } from \"../Data/GameData\";\r\nimport { ui } from \"../ui/layaMaxUI\";\r\nexport default class PlayerBullet {\r\n    constructor() {\r\n        this.bulletType = 1;\r\n        this.direction = 1;\r\n        this.speed = 35;\r\n    }\r\n    createView(type, dir) {\r\n        this.bulletType = type;\r\n        this.direction = dir;\r\n        this.view = fairygui.UIPackage.createObject(\"Game\", \"zidan\");\r\n        this.view.m_zidan.url = \"ui://Game/playerzidan\" + this.bulletType;\r\n        if (this.bulletType == GameData.WEAPON_RIFLE) {\r\n            if (this.direction == 4 || this.direction == -4) {\r\n                this.scene = new ui.BulletRifleUpUI();\r\n            }\r\n            else\r\n                this.scene = new ui.BulletRifleUI();\r\n        }\r\n        else {\r\n            if (this.direction == 4 || this.direction == -4) {\r\n                this.scene = new ui.BulletUpUI();\r\n            }\r\n            else\r\n                this.scene = new ui.BulletUI();\r\n        }\r\n        this.loadComplete();\r\n    }\r\n    loadComplete() {\r\n        ViewManager.instance.warView.scene.addChild(this.scene);\r\n        this.scene.addComponent(BulletBody);\r\n        this.script = this.scene.getComponent(BulletBody);\r\n        this.body = this.scene.getComponent(Laya.RigidBody);\r\n        this.box = this.scene.getComponent(Laya.BoxCollider);\r\n        this.box.label = this.body.label = \"PlayerBullet\" + this.bulletType;\r\n        this.setBulletPos();\r\n        EventManager.instance.addNotice(GameEvent.CLEAR_WAR_VIEW, this, this.disposeAll);\r\n        EventManager.instance.addNotice(GameEvent.BULLET_DISPOSE, this, this.disposeBullet);\r\n        EventManager.instance.addNotice(GameEvent.PLAYER_BULLET_HIT_ENEMY, this, this.hitEnemy);\r\n        EventManager.instance.addNotice(GameEvent.PLAYER_BULLET_HIT_OBSTACLE, this, this.hitEnemy);\r\n    }\r\n    hitEnemy(s) {\r\n        if (this.bulletType == GameData.WEAPON_RIFLE)\r\n            return;\r\n        if (s.s == this.box.owner) {\r\n            this.body.setVelocity({ x: 0, y: 0 });\r\n            this.view.m_zidan.url = \"ui://Game/bulletDisAni\";\r\n            this.view.m_zidan.content.setPlaySettings(0, -1, 1, 0, Laya.Handler.create(this, this.disposeAll));\r\n        }\r\n    }\r\n    disposeAll() {\r\n        EventManager.instance.offNotice(GameEvent.CLEAR_WAR_VIEW, this, this.disposeAll);\r\n        EventManager.instance.offNotice(GameEvent.BULLET_DISPOSE, this, this.disposeBullet);\r\n        EventManager.instance.offNotice(GameEvent.PLAYER_BULLET_HIT_ENEMY, this, this.hitEnemy);\r\n        EventManager.instance.offNotice(GameEvent.PLAYER_BULLET_HIT_OBSTACLE, this, this.hitEnemy);\r\n        if (this.scene) {\r\n            this.script.isRemove = true;\r\n            this.scene.removeSelf();\r\n        }\r\n        this.view.dispose();\r\n        Laya.Pool.recover(\"PlayerBullet\", this);\r\n    }\r\n    disposeBullet(s) {\r\n        if (s == this.body.owner) {\r\n            this.disposeAll();\r\n        }\r\n    }\r\n    setBulletPos() {\r\n        var p = ViewManager.instance.getPlayerBulletOffSetPos(this.direction, this.bulletType);\r\n        var c = ViewManager.instance.rolePlayer.roleBody.getWorldCenter();\r\n        if (this.bulletType == GameData.WEAPON_RIFLE) {\r\n            this.view.x = p.x;\r\n            this.view.y = p.y;\r\n            this.scene.addChild(this.view.displayObject);\r\n            var b = this.scene.getComponent(BulletBody);\r\n            b.onAwake();\r\n            if (this.direction > 0) {\r\n                this.scene.x = c.x + 45;\r\n                if (this.direction == 2) {\r\n                    this.scene.y = c.y;\r\n                    this.view.setSkew(15, 15);\r\n                }\r\n                else if (this.direction == 3) {\r\n                    this.scene.y = c.y - this.scene.height;\r\n                    this.view.setSkew(-15, -15);\r\n                }\r\n                else if (this.direction == 4) {\r\n                    this.scene.y = c.y - this.scene.height;\r\n                    this.scene.x = c.x - this.scene.width / 2;\r\n                    this.view.setSkew(-90, -90);\r\n                }\r\n                else {\r\n                    this.scene.y = c.y - this.scene.height / 2;\r\n                    this.view.setSkew(0, 0);\r\n                }\r\n            }\r\n            else {\r\n                this.scene.x = c.x - this.scene.width - 45;\r\n                if (this.direction == -2) {\r\n                    this.scene.y = c.y;\r\n                    this.view.setSkew(165, 165);\r\n                }\r\n                else if (this.direction == -3) {\r\n                    this.scene.y = c.y - this.scene.height;\r\n                    this.view.setSkew(195, 195);\r\n                }\r\n                else if (this.direction == -4) {\r\n                    this.scene.y = c.y - this.scene.height;\r\n                    this.scene.x = c.x - this.scene.width / 2;\r\n                    this.view.setSkew(270, 270);\r\n                }\r\n                else {\r\n                    this.scene.y = c.y - this.scene.height / 2;\r\n                    this.view.setSkew(180, 180);\r\n                }\r\n            }\r\n            this.view.m_zidan.content.setPlaySettings(0, -1, 1, 0, Laya.Handler.create(this, this.disposeAll));\r\n        }\r\n        else {\r\n            if (this.direction == 1 || this.direction == -1 || this.direction == 5 || this.direction == -5) {\r\n                var y = ViewManager.instance.bulletRandomY();\r\n                this.scene.x = c.x + p.x;\r\n                this.scene.y = c.y - y + p.y;\r\n            }\r\n            else {\r\n                this.scene.x = c.x + p.x;\r\n                this.scene.y = c.y + p.y;\r\n            }\r\n            this.scene.addChild(this.view.displayObject);\r\n            var b = this.scene.getComponent(BulletBody);\r\n            b.onAwake();\r\n            if (this.direction > 0) {\r\n                if (this.direction == 2) {\r\n                    this.view.setSkew(25, 25);\r\n                    this.body.setVelocity({ x: 11, y: 8 });\r\n                }\r\n                else if (this.direction == 3) {\r\n                    this.view.setSkew(-35, -35);\r\n                    this.body.setVelocity({ x: 11, y: -9 });\r\n                }\r\n                else if (this.direction == 4) {\r\n                    this.view.setSkew(-90, -90);\r\n                    this.body.setVelocity({ x: 0, y: -10 });\r\n                }\r\n                else {\r\n                    this.view.setSkew(0, 0);\r\n                    this.body.setVelocity({ x: 12, y: 0 });\r\n                }\r\n            }\r\n            else {\r\n                if (this.direction == -2) {\r\n                    this.view.setSkew(155, 155);\r\n                    this.body.setVelocity({ x: -11, y: 8 });\r\n                }\r\n                else if (this.direction == -3) {\r\n                    this.view.setSkew(215, 215);\r\n                    this.body.setVelocity({ x: -11, y: -9 });\r\n                }\r\n                else if (this.direction == -4) {\r\n                    this.view.setSkew(270, 270);\r\n                    this.body.setVelocity({ x: 0, y: -10 });\r\n                }\r\n                else {\r\n                    this.view.setSkew(180, 180);\r\n                    this.body.setVelocity({ x: -12, y: 0 });\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n",
  "references": [
    "D:/littleGame/gunfire/src/fui/Game/WXFUI_zidan.ts",
    "D:/littleGame/gunfire/src/Manager/ViewManager.ts",
    "D:/littleGame/gunfire/src/Control/GameEvent.ts",
    "D:/littleGame/gunfire/src/Manager/EventManager.ts",
    "D:/littleGame/gunfire/src/View/Body/BulletBody.ts",
    "D:/littleGame/gunfire/src/Data/GameData.ts",
    "D:/littleGame/gunfire/src/ui/layaMaxUI.ts"
  ]
}
