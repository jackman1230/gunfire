{
  "code": "import { ViewManager } from \"../Manager/ViewManager\";\r\nimport GameEvent from \"../Control/GameEvent\";\r\nimport { EventManager } from \"../Manager/EventManager\";\r\nimport { BombData } from \"../Data/GameData\";\r\nimport BombBody from \"./Body/BombBody\";\r\nimport BoomView from \"./BoomView\";\r\nimport { SoundManager } from \"../Manager/SoundManager\";\r\nimport { ui } from \"../ui/layaMaxUI\";\r\nexport default class BombView {\r\n    constructor() {\r\n        this.bombType = 1;\r\n        this.direction = 1;\r\n        this.isPlayer = false;\r\n    }\r\n    createView(type, dir, s, p, offPos) {\r\n        this.bombType = type;\r\n        this.direction = dir;\r\n        this.parentPos = s;\r\n        this.isPlayer = p;\r\n        this.offPos = offPos;\r\n        this.scene = new ui.BombBodyUI();\r\n        this.loadComplete();\r\n    }\r\n    loadComplete() {\r\n        this.view = fairygui.UIPackage.createObject(\"Game\", \"Bomb\");\r\n        this.view.m_boom3.visible = this.view.m_boom.visible = this.view.m_boom2.visible = false;\r\n        if (this.bombType == BombData.BOMB_MOR) {\r\n            this.view.m_boom.visible = true;\r\n            this.trans = this.view.getTransitionAt(0);\r\n        }\r\n        else if (this.bombType == BombData.BOMB_ENEMY_GRE || this.bombType == BombData.BOMB_MY_GRE) {\r\n            this.view.m_boom2.visible = true;\r\n            this.trans = this.view.getTransitionAt(1);\r\n        }\r\n        else if (this.bombType == BombData.BOMB_FIRE) {\r\n            this.view.m_boom3.visible = true;\r\n            this.trans = this.view.getTransitionAt(2);\r\n        }\r\n        this.scene.addComponent(BombBody);\r\n        this.body = this.scene.getComponent(Laya.RigidBody);\r\n        this.box = this.scene.getComponent(Laya.BoxCollider);\r\n        if (this.isPlayer) {\r\n            this.box.label = this.body.label = \"PlayerBomb\";\r\n        }\r\n        else {\r\n            this.box.label = this.body.label = \"enemyBomb\";\r\n        }\r\n        this.view.m_boom3.url = this.view.m_boom.url = this.view.m_boom2.url = \"ui://Game/zhadan_\" + this.bombType;\r\n        if (this.bombType == BombData.BOMB_ENEMY_GRE)\r\n            this.view.m_boom2.content.setPlaySettings(0, -1, 0, 0);\r\n        if (this.bombType == BombData.BOMB_MY_GRE || this.bombType == BombData.BOMB_ENEMY_GRE)\r\n            this.trans.play(null, 1);\r\n        this.scene.addChild(this.view.displayObject);\r\n        ViewManager.instance.warView.scene.addChild(this.scene);\r\n        this.setBombPos();\r\n        EventManager.instance.addNotice(GameEvent.CLEAR_WAR_VIEW, this, this.disposeAll);\r\n        EventManager.instance.addNotice(GameEvent.PLAYER_BOMB_HIT_ENEMY, this, this.dispose);\r\n        EventManager.instance.addNotice(GameEvent.ENEMY_BOMB_HIT_PLAYER, this, this.dispose);\r\n        EventManager.instance.addNotice(GameEvent.BOMB_DISPOSE, this, this.dispose);\r\n        EventManager.instance.addNotice(GameEvent.PLAYER_BOMB_HIT_OBSTACLE, this, this.dispose);\r\n    }\r\n    setBombPos() {\r\n        if (this.direction == 1) {\r\n            if (this.bombType == BombData.BOMB_MOR) {\r\n                this.body.setVelocity({ x: 7, y: -6 });\r\n                this.trans.play(null, 1, 0, 0, 1.25);\r\n            }\r\n            else if (this.bombType == BombData.BOMB_FIRE) {\r\n                this.body.setVelocity({ x: 12, y: 0 });\r\n                this.trans.play(null, 1, 0, 0, 1.25);\r\n            }\r\n            else if (this.bombType == BombData.BOMB_MY_GRE) {\r\n                this.body.setVelocity({ x: 10, y: -7 });\r\n            }\r\n            else if (this.bombType == BombData.BOMB_ENEMY_GRE) {\r\n                this.body.setVelocity({ x: 7, y: -6 });\r\n            }\r\n        }\r\n        else {\r\n            if (this.bombType == BombData.BOMB_MOR) {\r\n                this.body.setVelocity({ x: -7, y: -6 });\r\n                this.trans.play(null, 1, 0, 1.5, 2.75);\r\n            }\r\n            else if (this.bombType == BombData.BOMB_FIRE) {\r\n                this.body.setVelocity({ x: -12, y: 0 });\r\n                this.trans.play(null, 1, 0, 1.5, 2.75);\r\n            }\r\n            else if (this.bombType == BombData.BOMB_MY_GRE) {\r\n                this.body.setVelocity({ x: -10, y: -7 });\r\n            }\r\n            else if (this.bombType == BombData.BOMB_ENEMY_GRE) {\r\n                this.body.setVelocity({ x: -7, y: -6 });\r\n            }\r\n        }\r\n        this.scene.x = this.parentPos.x + this.offPos.x;\r\n        this.scene.y = this.parentPos.y + this.offPos.y;\r\n    }\r\n    showBoomView() {\r\n        SoundManager.instance.playSound(\"boom\");\r\n        var bomb = Laya.Pool.getItemByClass(\"boomView\", BoomView);\r\n        var p = ViewManager.instance.getBodyCenterPos(this.scene);\r\n        bomb.createView(ViewManager.instance.getBoomAniTypeByBomb(this.bombType), p, this.isPlayer);\r\n    }\r\n    dispose(s) {\r\n        if (s.s == this.box.owner) {\r\n            this.showBoomView();\r\n            this.disposeAll();\r\n        }\r\n    }\r\n    disposeAll() {\r\n        EventManager.instance.offNotice(GameEvent.CLEAR_WAR_VIEW, this, this.disposeAll);\r\n        EventManager.instance.offNotice(GameEvent.PLAYER_BOMB_HIT_ENEMY, this, this.dispose);\r\n        EventManager.instance.offNotice(GameEvent.ENEMY_BOMB_HIT_PLAYER, this, this.dispose);\r\n        EventManager.instance.offNotice(GameEvent.BOMB_DISPOSE, this, this.dispose);\r\n        Laya.Pool.recover(\"bombView\", this);\r\n        if (this.view)\r\n            this.view.dispose();\r\n        this.scene.removeSelf();\r\n    }\r\n}\r\n",
  "references": [
    "D:/littleGame/gunfire/src/Manager/ViewManager.ts",
    "D:/littleGame/gunfire/src/Control/GameEvent.ts",
    "D:/littleGame/gunfire/src/Manager/EventManager.ts",
    "D:/littleGame/gunfire/src/fui/Game/WXFUI_Bomb.ts",
    "D:/littleGame/gunfire/src/Data/GameData.ts",
    "D:/littleGame/gunfire/src/View/Body/BombBody.ts",
    "D:/littleGame/gunfire/src/View/BoomView.ts",
    "D:/littleGame/gunfire/src/Manager/SoundManager.ts",
    "D:/littleGame/gunfire/src/ui/layaMaxUI.ts"
  ]
}
