{
  "code": "import { WarView } from \"../View/WarView\";\r\nimport Player from \"../View/Player\";\r\nimport Enemy from \"../View/Enemy\";\r\nimport EnemyBullet from \"../View/EnemyBullet\";\r\nimport PlayerBullet from \"../View/PlayerBullet\";\r\nimport BombView from \"../View/BombView\";\r\nimport ObstacleView from \"../View/ObstacleView\";\r\nimport { BombData, ObstacleType } from \"../Data/GameData\";\r\nimport Chopper from \"../View/Chopper\";\r\nimport Tank from \"../View/Tank\";\r\nimport ChopperBomb from \"../View/ChopperBomb\";\r\nimport GoodsView from \"../View/GoodsView\";\r\nimport PlayerInfoView from \"../View/PlayerInfoView\";\r\nimport PlayerCtlView from \"../View/PlayerCtlView\";\r\nimport WXFUI_loadingView from \"../fui/loading/WXFUI_loadingView\";\r\nimport SuspendView from \"../View/SuspendView\";\r\nimport ChapterView from \"../View/ChapterView\";\r\nimport AfterWar from \"../View/AfterWar\";\r\nimport BeforeWar from \"../View/BeforeWar\";\r\nimport PopUpView from \"../View/PopUpView\";\r\nimport TipsPopView from \"../View/TipsPopView\";\r\nimport { SoundManager } from \"./SoundManager\";\r\nexport class ViewManager {\r\n    constructor() {\r\n        this.bulletArr = [];\r\n        this.enemyArr = [];\r\n        this.isChecking = false;\r\n        this.warAllView = [];\r\n        this.curPopView = [];\r\n        this.playerBulletPos = {\r\n            \"11\": [135, -22],\r\n            \"12\": [150, 0],\r\n            \"13\": [50, 70],\r\n            \"21\": [125, 25],\r\n            \"22\": [115, 70],\r\n            \"23\": [50, 5],\r\n            \"31\": [115, -95],\r\n            \"32\": [120, -50],\r\n            \"33\": [25, 130],\r\n            \"14\": [20, -60],\r\n            \"-11\": [-200, -22],\r\n            \"-12\": [-210, 0],\r\n            \"-13\": [240, 80],\r\n            \"-14\": [-20, -60],\r\n            \"-21\": [-190, 20],\r\n            \"-22\": [-180, 15],\r\n            \"-23\": [250, 20],\r\n            \"-31\": [-190, -90],\r\n            \"-32\": [-180, -50],\r\n            \"-33\": [255, 130],\r\n        };\r\n        this.enemyBulletPos = {\r\n            \"11\": [105, 10],\r\n            \"12\": [10, -40],\r\n            \"13\": [125, 15],\r\n            \"14\": [],\r\n            \"15\": [70, -20],\r\n            \"111\": [-25, 15],\r\n            \"112\": [-5, 25],\r\n            \"113\": [-75, 15],\r\n            \"114\": [-35, 15],\r\n            \"-11\": [-100, 10],\r\n            \"-12\": [0, -50],\r\n            \"-13\": [-75, 15],\r\n            \"-14\": [],\r\n            \"-15\": [0, -20],\r\n            \"-111\": [0, 15],\r\n            \"-112\": [-50, 30],\r\n            \"-113\": [20, 20],\r\n            \"-114\": [-20, 10],\r\n        };\r\n    }\r\n    static get instance() {\r\n        if (this._instance == null)\r\n            this._instance = new ViewManager();\r\n        return this._instance;\r\n    }\r\n    createLoaningView() {\r\n        this.loadingView = WXFUI_loadingView.createInstance();\r\n        this.loadingView.m_bar.text = \"0%\";\r\n        this.loadingView.m_bar.value = 0;\r\n        Laya.stage.addChild(this.loadingView.displayObject);\r\n    }\r\n    setLoadongProgress(p) {\r\n        this.loadingView.m_bar.m_title.text = Math.ceil(p * 100) + \"%\";\r\n        this.loadingView.m_bar.value = p * 100;\r\n    }\r\n    hideLoadingView() {\r\n        Laya.stage.removeChild(this.loadingView.displayObject);\r\n    }\r\n    createPlayer() {\r\n        if (!this.player) {\r\n            this.player = new Player();\r\n            this.player.createView();\r\n        }\r\n        else {\r\n            this.player.resetPos();\r\n        }\r\n    }\r\n    createWarView() {\r\n        if (this.warView)\r\n            this.warView.dispose();\r\n        this.warView = Laya.Pool.getItemByClass(\"warView\", WarView);\r\n        this.warView.createView();\r\n        this.showPlayerInfoView();\r\n    }\r\n    createBomb(type, dir, parentPos, b) {\r\n        var bomb = Laya.Pool.getItemByClass(\"bombView\", BombView);\r\n        if (b)\r\n            bomb.createView(BombData.BOMB_MY_GRE, dir, parentPos, b, this.getPlayerBulletOffSetPos(dir, type));\r\n        else\r\n            bomb.createView(type, dir, parentPos, b, this.getEnemyBulletOffSetPos(dir, type));\r\n    }\r\n    createChopperBomb(type, parentPos, s) {\r\n        var bomb = Laya.Pool.getItemByClass(\"ChopperBomb\", ChopperBomb);\r\n        bomb.createView(type, null, parentPos, null, s);\r\n    }\r\n    createBullet() {\r\n        var b = Laya.Pool.getItemByClass(\"PlayerBullet\", PlayerBullet);\r\n        b.createView(this.rolePlayer.weaponType, this.rolePlayer.faceType);\r\n        return b;\r\n    }\r\n    createEnemyBullet(type, dir, s) {\r\n        var b = Laya.Pool.getItemByClass(\"enemyBullet\", EnemyBullet);\r\n        b.createView(type, dir, s);\r\n    }\r\n    createObstacle(d) {\r\n        var b = Laya.Pool.getItemByClass(\"obstacle\", ObstacleView);\r\n        b.createView(d);\r\n    }\r\n    createEnemy(d) {\r\n        var b = Laya.Pool.getItemByClass(\"enemy\", Enemy);\r\n        b.createView(d);\r\n    }\r\n    createChopper(d) {\r\n        var b = Laya.Pool.getItemByClass(\"chopper\", Chopper);\r\n        b.createView(d);\r\n    }\r\n    createTank(d) {\r\n        var b = Laya.Pool.getItemByClass(\"tank\", Tank);\r\n        b.createView(d);\r\n    }\r\n    createGoods(type, s) {\r\n        var b = Laya.Pool.getItemByClass(\"goods\", GoodsView);\r\n        b.createView(type, s);\r\n    }\r\n    showPlayerInfoView() {\r\n        if (!this.playerInfoView)\r\n            this.playerInfoView = new PlayerInfoView();\r\n        this.playerInfoView.updateAllView();\r\n        fairygui.GRoot.inst.addChild(this.playerInfoView.view);\r\n    }\r\n    showPlayerCtlView() {\r\n        if (!this.playerCtlView)\r\n            this.playerCtlView = new PlayerCtlView();\r\n        fairygui.GRoot.inst.addChild(this.playerCtlView.view);\r\n    }\r\n    showAfterWarView(type) {\r\n        this.afterWar.view.m_ctl.selectedIndex = type - 1;\r\n        this.afterWar.updateCoin();\r\n        this.showPopUpView(this.afterWar, true, true, false);\r\n    }\r\n    showBeforeWarView() {\r\n        this.showPopUpView(this.beforeWar);\r\n    }\r\n    showSuspendView() {\r\n        this.showPopUpView(this.suspendView);\r\n    }\r\n    showChapterView() {\r\n        SoundManager.instance.stopBGM();\r\n        this.chapterView.view.m_chapter.selectedIndex = 0;\r\n        this.chapterView.updateView();\r\n        this.showPopUpView(this.chapterView, false, true);\r\n    }\r\n    initPopUpView() {\r\n        this.afterWar = new AfterWar();\r\n        this.beforeWar = new BeforeWar();\r\n        this.suspendView = new SuspendView();\r\n        this.chapterView = new ChapterView();\r\n        this.popUpView = new PopUpView();\r\n        this.tipsView = new TipsPopView();\r\n        this.afterWar.createView();\r\n        this.beforeWar.createView();\r\n        this.suspendView.createView();\r\n        this.chapterView.createView();\r\n        Laya.stage.addChild(fairygui.GRoot.inst.displayObject);\r\n    }\r\n    showTipsView(str) {\r\n        this.tipsView.showView(str);\r\n    }\r\n    showPopUpView(p, showMask = true, hideOther = false, clickMaskHide = true) {\r\n        if (hideOther) {\r\n            for (let i = 0; i < this.curPopView.length; i++) {\r\n                var t = this.curPopView[i];\r\n                t.hideAllView();\r\n            }\r\n            this.curPopView.length = 0;\r\n        }\r\n        p.showView(showMask, clickMaskHide);\r\n        this.curPopView.push(p);\r\n    }\r\n    hidePopUpView(p, all = false) {\r\n        if (all) {\r\n            for (let i = 0; i < this.curPopView.length; i++) {\r\n                var t = this.curPopView[i];\r\n                t.hideAllView();\r\n            }\r\n            this.curPopView.length = 0;\r\n        }\r\n        else {\r\n            if (p)\r\n                p.hideAllView();\r\n        }\r\n    }\r\n    removeWarView() {\r\n        if (this.warView) {\r\n            this.warView.removeView();\r\n        }\r\n    }\r\n    get rolePlayer() {\r\n        return this.player;\r\n    }\r\n    getBodyCenterPos(s) {\r\n        return s.getComponent(Laya.RigidBody).getWorldCenter();\r\n    }\r\n    updateViewPort(moveX) {\r\n        this.warView.updateViewPort(moveX);\r\n    }\r\n    getBoomAniTypeByBomb(type) {\r\n        if (type == BombData.BOMB_MY_GRE || type == BombData.BOMB_MY_GRE || type == BombData.BOMB_CHOPPER) {\r\n            return 1;\r\n        }\r\n        else if (type == BombData.BOMB_MOR) {\r\n            return 2;\r\n        }\r\n        else if (type == BombData.BOMB_TANK) {\r\n            return 3;\r\n        }\r\n        return 1;\r\n    }\r\n    getBoomAniTypeByObsType(type) {\r\n        if (type == ObstacleType.ObstacleType_SHABAO || type == ObstacleType.ObstacleType_YOUGUAN || type == ObstacleType.ObstacleType_9) {\r\n            return 2;\r\n        }\r\n        else if (type == ObstacleType.ObstacleType_DACHE || type == ObstacleType.ObstacleType_11) {\r\n            return 5;\r\n        }\r\n        else {\r\n            return 3;\r\n        }\r\n    }\r\n    bulletRandomY() {\r\n        return Math.floor(Math.random() * 10) + 10;\r\n    }\r\n    getPlayerDirection(pos) {\r\n        var rad = Math.atan2(pos.y, pos.x);\r\n        if ((rad >= -2 * Math.PI / 8 && rad < 0) || (rad >= 0 && rad < 2 * Math.PI / 8)) {\r\n            return 1;\r\n        }\r\n        else if (rad >= 2 * Math.PI / 8 && rad < 4 * Math.PI / 8) {\r\n            return 2;\r\n        }\r\n        else if (rad >= 4 * Math.PI / 8 && rad < 6 * Math.PI / 8) {\r\n            return -2;\r\n        }\r\n        else if ((rad >= 6 * Math.PI / 8 && rad < Math.PI) || (rad >= -Math.PI && rad < -6 * Math.PI / 8)) {\r\n            return -1;\r\n        }\r\n        else if (rad >= -6 * Math.PI / 8 && rad < -4 * Math.PI / 8) {\r\n            return -3;\r\n        }\r\n        else {\r\n            return 3;\r\n        }\r\n    }\r\n    getPlayerBulletOffSetPos(dir, weaponType) {\r\n        var s = dir + \"\" + weaponType;\r\n        if (this.playerBulletPos[s])\r\n            return new Laya.Point(this.playerBulletPos[s][0], this.playerBulletPos[s][1]);\r\n        else\r\n            return new Laya.Point(0, 0);\r\n    }\r\n    getEnemyBulletOffSetPos(dir, weaponType) {\r\n        var s = dir + \"\" + weaponType;\r\n        if (this.enemyBulletPos[s])\r\n            return new Laya.Point(this.enemyBulletPos[s][0], this.enemyBulletPos[s][1]);\r\n        else\r\n            return new Laya.Point(0, 0);\r\n    }\r\n}\r\n",
  "references": [
    "D:/littleGame/gunfire/src/View/WarView.ts",
    "D:/littleGame/gunfire/src/fui/Game/WXFUI_Player.ts",
    "D:/littleGame/gunfire/src/View/Player.ts",
    "D:/littleGame/gunfire/src/View/Enemy.ts",
    "D:/littleGame/gunfire/src/View/EnemyBullet.ts",
    "D:/littleGame/gunfire/src/View/PlayerBullet.ts",
    "D:/littleGame/gunfire/src/View/BombView.ts",
    "D:/littleGame/gunfire/src/View/ObstacleView.ts",
    "D:/littleGame/gunfire/src/Data/GameData.ts",
    "D:/littleGame/gunfire/src/View/Chopper.ts",
    "D:/littleGame/gunfire/src/View/Tank.ts",
    "D:/littleGame/gunfire/src/Data/PlayerData.ts",
    "D:/littleGame/gunfire/src/View/ChopperBomb.ts",
    "D:/littleGame/gunfire/src/View/GoodsView.ts",
    "D:/littleGame/gunfire/src/View/PlayerInfoView.ts",
    "D:/littleGame/gunfire/src/View/PlayerCtlView.ts",
    "D:/littleGame/gunfire/src/fui/loading/WXFUI_loadingView.ts",
    "D:/littleGame/gunfire/src/View/SuspendView.ts",
    "D:/littleGame/gunfire/src/View/ChapterView.ts",
    "D:/littleGame/gunfire/src/View/AfterWar.ts",
    "D:/littleGame/gunfire/src/View/BeforeWar.ts",
    "D:/littleGame/gunfire/src/View/PopUpView.ts",
    "D:/littleGame/gunfire/src/Manager/GameManager.ts",
    "D:/littleGame/gunfire/src/View/TipsPopView.ts",
    "D:/littleGame/gunfire/src/Manager/EventManager.ts",
    "D:/littleGame/gunfire/src/Control/GameEvent.ts",
    "D:/littleGame/gunfire/src/Manager/SoundManager.ts"
  ]
}
