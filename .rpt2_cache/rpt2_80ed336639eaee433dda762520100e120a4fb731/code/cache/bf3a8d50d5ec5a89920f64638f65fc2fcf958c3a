{
  "code": "import PlayerAni from \"./PlayerAni\";\r\nimport { ViewManager } from \"../Manager/ViewManager\";\r\nexport default class Player {\r\n    constructor() {\r\n        this.direction = 0;\r\n        this.sRun = false;\r\n        this.keyRight = false;\r\n        this.keyLeft = false;\r\n        this.keyJump = false;\r\n        this.speed = 3;\r\n        this.jumpHigh = 200;\r\n        this.weaponType = 1;\r\n    }\r\n    initView() {\r\n        this.rolePlayer = fairygui.UIPackage.createObject(\"Game\", \"Player\");\r\n        this.rolePlayer.setPivot(0.5, 0.5);\r\n        this.body = this.rolePlayer.getChildAt(0);\r\n        this.playerAni = new PlayerAni();\r\n        this.playerAni.initView();\r\n        this.body.url = \"ui://Game/player_jump_1\";\r\n        Laya.stage.on(Laya.Event.KEY_DOWN, this, this.keyDowmEvent);\r\n        Laya.stage.on(Laya.Event.KEY_UP, this, this.keyUpEvent);\r\n        var g = this.body.component;\r\n        var mc = g.getChildAt(0).content;\r\n        var ctl = g.getController(\"ctl\");\r\n        mc.color = \"#ff0000\";\r\n        console.log(ctl);\r\n        console.log(mc);\r\n    }\r\n    ;\r\n    keyUpEvent(e) {\r\n        var keyCode = e[\"keyCode\"];\r\n        switch (keyCode) {\r\n            case 65:\r\n                this.keyLeft = false;\r\n                if (this.keyRight == false) {\r\n                    this.sRun = false;\r\n                    if (this.keyJump == false)\r\n                        this.setStay();\r\n                }\r\n                break;\r\n            case 68:\r\n                this.keyRight = false;\r\n                if (this.keyLeft == false) {\r\n                    this.sRun = false;\r\n                    if (this.keyJump == false)\r\n                        this.setStay();\r\n                }\r\n                break;\r\n        }\r\n    }\r\n    keyDowmEvent(e) {\r\n        var keyCode = e[\"keyCode\"];\r\n        console.log(keyCode);\r\n        switch (keyCode) {\r\n            case 87:\r\n                console.log(\"上\");\r\n                break;\r\n            case 83:\r\n                console.log(\"下\");\r\n                break;\r\n            case 65:\r\n                this.keyLeft = true;\r\n                console.log(\"左\");\r\n                this.setLeft();\r\n                if (this.sRun)\r\n                    return;\r\n                this.setRun();\r\n                this.stillRun();\r\n                break;\r\n            case 68:\r\n                this.keyRight = true;\r\n                console.log(\"右\");\r\n                this.setRight();\r\n                if (this.sRun)\r\n                    return;\r\n                this.setRun();\r\n                this.stillRun();\r\n                break;\r\n            case 32:\r\n                console.log(\"跳\");\r\n                if (this.keyJump)\r\n                    return;\r\n                this.setJump();\r\n                break;\r\n        }\r\n    }\r\n    setLeft() {\r\n        if (this.direction == -1)\r\n            return;\r\n        this.direction = -1;\r\n        this.rolePlayer.skewY = 0;\r\n    }\r\n    setRight() {\r\n        if (this.direction == 1)\r\n            return;\r\n        this.direction = 1;\r\n        this.rolePlayer.skewY = 180;\r\n    }\r\n    setJump() {\r\n        this.keyJump = true;\r\n        this.playerAni.legJump.setPlaySettings(1, -1, 1, 5);\r\n        Laya.Tween.to(this.rolePlayer, { y: this.rolePlayer.y - this.jumpHigh }, 400, null, Laya.Handler.create(this, this.jumpEnd));\r\n    }\r\n    setRun() {\r\n        if (this.sRun)\r\n            return;\r\n        this.body.url = \"ui://Game/player_run_\" + this.weaponType;\r\n        this.sRun = true;\r\n        Laya.timer.clear(this, this.stillRun);\r\n        Laya.timer.frameLoop(1, this, this.stillRun);\r\n    }\r\n    stillRun() {\r\n        if (this.direction == 1) {\r\n            this.rolePlayer.x += this.speed;\r\n            console.log(\"this.rolePlayer.x-- \" + this.rolePlayer.x);\r\n            if (this.rolePlayer.x >= Laya.Browser.clientWidth / 2) {\r\n                this.rolePlayer.x = Laya.Browser.clientWidth / 2;\r\n                ViewManager.instance.updateViewPort(this.speed);\r\n            }\r\n        }\r\n        else {\r\n            this.rolePlayer.x -= this.speed;\r\n            if (this.rolePlayer.x < 1)\r\n                this.rolePlayer.x = 1;\r\n        }\r\n    }\r\n    setFire() {\r\n        this.body.url = \"ui://Game/player_fire_\" + this.weaponType;\r\n    }\r\n    setBoom() {\r\n        this.body.url = \"ui://Game/player_boom_\" + this.weaponType;\r\n        Laya.timer.once(300, this, this.setBoomComplete);\r\n    }\r\n    setBoomComplete() {\r\n        if (this.sRun)\r\n            this.body.url = \"ui://Game/player_run_\" + this.weaponType;\r\n    }\r\n    setStay() {\r\n        this.body.url = \"ui://Game/player_stay_\" + this.weaponType;\r\n        this.keyLeft = false;\r\n        this.keyRight = false;\r\n        this.sRun = false;\r\n        Laya.timer.clear(this, this.stillRun);\r\n    }\r\n    jumpEnd() {\r\n        this.keyJump = false;\r\n    }\r\n}\r\n",
  "references": [
    "D:/littleGame/gunfire/src/fui/Game/WXFUI_Player.ts",
    "D:/littleGame/gunfire/src/View/PlayerAni.ts",
    "D:/littleGame/gunfire/src/Manager/ViewManager.ts"
  ]
}
