{
  "code": "import PopUpView from \"../PopUpView\";\r\nimport { SoundManager } from \"../../Manager/SoundManager\";\r\nimport { GameManager } from \"../../Manager/GameManager\";\r\nimport WXFUI_ADListView from \"../../fui/Game/WXFUI_ADListView\";\r\nimport { ViewManager } from \"../../Manager/ViewManager\";\r\nimport { EventManager } from \"../../Manager/EventManager\";\r\nimport GameEvent from \"../../Control/GameEvent\";\r\nimport { MooSnowSDK } from \"../../Manager/MooSnowSDK\";\r\nexport default class ADListView extends PopUpView {\r\n    constructor() {\r\n        super();\r\n        this.floor = 0;\r\n        this.ceil = 0;\r\n        this.type = 0;\r\n        this.timer = 4;\r\n    }\r\n    createView() {\r\n        this.view = WXFUI_ADListView.createInstance();\r\n        this.view.m_jixu.onClick(this, this.continueGame);\r\n        this.view.m_time.text = \" 0\";\r\n        this.view.m_ad_1.m_list.itemRenderer = Laya.Handler.create(this, this.setADItem1, null, false);\r\n        this.view.m_ad_2.m_list.itemRenderer = Laya.Handler.create(this, this.setADItem2, null, false);\r\n        this.view.m_ad_1.m_list.on(fairygui.Events.CLICK_ITEM, this, this.onClickItem);\r\n        this.view.m_ad_2.m_list.on(fairygui.Events.CLICK_ITEM, this, this.onClickItem);\r\n        EventManager.instance.addNotice(GameEvent.SHOW_AD_LIST, this, this.showADList);\r\n    }\r\n    showView(s, c) {\r\n        super.showView(s, c);\r\n        var pro = ViewManager.instance.getProportion();\r\n        if (pro > 0)\r\n            this.view.m_n6.setScale(1 + pro, 1 + pro);\r\n        this.view.m_ad_1.m_list.x = this.view.m_ad_2.m_list.x = 0;\r\n        this.showADList();\r\n        this.view.m_ctl.selectedIndex = 0;\r\n        this.timer = 4;\r\n        this.showTxt();\r\n        this.showTimer();\r\n        this.adMoveLeft();\r\n        var d = MooSnowSDK.getAllConfig();\r\n        if (d && d.exportAutoNavigate && d.exportAutoNavigate != 0) {\r\n            this.gotoRandomGame();\r\n        }\r\n    }\r\n    showTimer() {\r\n        Laya.timer.loop(1000, this, this.showTxt);\r\n    }\r\n    showTxt() {\r\n        this.timer--;\r\n        if (this.timer <= 0) {\r\n            this.view.m_ctl.selectedIndex = 1;\r\n            Laya.timer.clear(this, this.showTxt);\r\n        }\r\n        this.view.m_time.text = this.timer + \"\";\r\n    }\r\n    continueGame() {\r\n        SoundManager.instance.playSound(\"btn_click\");\r\n        ViewManager.instance.adListView.hideAllView();\r\n        if (this.type == 1) {\r\n            GameManager.instance.goFirstPage();\r\n        }\r\n    }\r\n    showADList() {\r\n        if (GameManager.instance.adList.length < 1)\r\n            return;\r\n        EventManager.instance.offNotice(GameEvent.SHOW_AD_LIST, this, this.showADList);\r\n        this.view.m_ad_1.m_list.width = 240 * GameManager.instance.adList.length;\r\n        this.view.m_ad_2.m_list.width = 240 * GameManager.instance.adList.length;\r\n        this.view.m_ad_1.m_list.numItems = GameManager.instance.adList.length;\r\n        this.view.m_ad_2.m_list.numItems = GameManager.instance.adList.length;\r\n        this.view.m_ad_2.m_list.x = this.view.m_ad_1.m_list.x = 0;\r\n    }\r\n    onClickItem(e) {\r\n        var m = e.data;\r\n        console.log(\"ad--\", m);\r\n        if (!m)\r\n            return;\r\n        moosnow.platform.navigate2Mini(m, (res) => {\r\n            console.log('跳转成功 ', res);\r\n        }, (res) => {\r\n            console.log('跳转失败 ', res);\r\n        });\r\n    }\r\n    setADItem1(index, item) {\r\n        var d = GameManager.instance.adOriList[index];\r\n        if (!d)\r\n            return;\r\n        item.data = d;\r\n        item.m_icon.url = d.img;\r\n        item.m_name.text = d.title;\r\n    }\r\n    setADItem2(index, item) {\r\n        var d = GameManager.instance.adListRever[index];\r\n        if (!d)\r\n            return;\r\n        item.data = d;\r\n        item.m_icon.url = d.img;\r\n        item.m_name.text = d.title;\r\n    }\r\n    adMoveLeft() {\r\n        this._tweenNum = Laya.Tween.to(this.view.m_ad_1.m_list, { x: this.view.m_ad_1.width - 240 * GameManager.instance.adOriList.length }, GameManager.instance.adTime, null, Laya.Handler.create(this, this.adMoveRight));\r\n        this._tweenNum.update = Laya.Handler.create(this, this.updateTween, null, false);\r\n    }\r\n    adMoveRight() {\r\n        this._tweenNum = Laya.Tween.to(this.view.m_ad_1.m_list, { x: 0 }, GameManager.instance.adTime, null, Laya.Handler.create(this, this.adMoveLeft));\r\n        this._tweenNum.update = Laya.Handler.create(this, this.updateTween, null, false);\r\n    }\r\n    updateTween() {\r\n        this.view.m_ad_2.m_list.x = this.view.m_ad_1.m_list.x;\r\n    }\r\n    hideAllView() {\r\n        super.hideAllView();\r\n        Laya.Tween.clearTween(this.view.m_ad_1.m_list);\r\n        Laya.timer.clearAll(this);\r\n    }\r\n    gotoRandomGame() {\r\n        var n = Math.floor(Math.random() * GameManager.instance.adList.length);\r\n        var d = GameManager.instance.adList[n];\r\n        if (!d)\r\n            return;\r\n        moosnow.platform.navigate2Mini(d, (res) => {\r\n            console.log('跳转成功 ', res);\r\n        }, (res) => {\r\n            console.log('跳转失败 ', res);\r\n        });\r\n    }\r\n}\r\n",
  "references": [
    "D:/littleGame/gunfire/src/View/PopUpView.ts",
    "D:/littleGame/gunfire/src/fui/Game/WXFUI_AfterWar.ts",
    "D:/littleGame/gunfire/src/Manager/SoundManager.ts",
    "D:/littleGame/gunfire/src/Manager/GameManager.ts",
    "D:/littleGame/gunfire/src/fui/Game/WXFUI_ADItem.ts",
    "D:/littleGame/gunfire/src/fui/Game/WXFUI_ADListView.ts",
    "D:/littleGame/gunfire/src/Manager/ViewManager.ts",
    "D:/littleGame/gunfire/src/Manager/EventManager.ts",
    "D:/littleGame/gunfire/src/Control/GameEvent.ts",
    "D:/littleGame/gunfire/src/Manager/MooSnowSDK.ts"
  ]
}
